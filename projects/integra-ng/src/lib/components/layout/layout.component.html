<div class="layout">
  <div class="layout-wrapper" [ngClass]="containerClass()">
    <i-topbar [config]="config">
      <ng-content select="[topbarActions]" />
    </i-topbar>
    <div class="layout-body">
      <div
        class="layout-sidebar-container"
        [ngClass]="{
          'sidebar-open': layoutService.state().isSidebarOpen,
          'sidebar-closed': !layoutService.state().isSidebarOpen
        }"
      >
        <i-sidebar [menuModel]="menuModel" />
      </div>
      <div class="layout-main-container" #mainContainer>
        @if (config.enablePullToRefresh && layoutService.state().isMobileViewport) {
          <div 
            class="pull-to-refresh-indicator"
            [style.transform]="'translateY(' + Math.max(-60, pullDistance() - 60) + 'px)'"
            [style.opacity]="Math.min(1, pullDistance() / 80)"
          >
            <div class="refresh-icon" [class.refreshing]="isRefreshing()">
              <i class="pi pi-refresh"></i>
            </div>
            <div class="refresh-text">
              {{ isRefreshing() ? 'Refreshing...' : (pullDistance() >= 80 ? 'Release to refresh' : 'Pull to refresh') }}
            </div>
          </div>
        }
        <div class="layout-main">
          <router-outlet />
        </div>
      </div>
    </div>
    <div class="layout-mask" (click)="hideMenu()"></div>
  </div>
</div>
