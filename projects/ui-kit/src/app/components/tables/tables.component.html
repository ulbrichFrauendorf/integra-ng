<div class="tables-demo">
  <!-- Whisper container required for toast/whisper messages from demo actions -->
  <i-whisper [position]="'top-right'" [key]="'global'"></i-whisper>
  <header class="demo-header">
    <h1>Table Component</h1>
    <p>
      A comprehensive table component with sorting, filtering, selection, and
      row actions. All features are configurable via props.
    </p>
  </header>

  <div class="cards-container">
    <!-- Basic Table with Sorting & Filtering -->
    <app-demo-card
      [title]="'Basic Table with Sorting & Filtering'"
      [sourceCode]="codeExamples.filtering"
    >
      <p class="demo-description">
        Click column headers to sort. Use global search or column filters to
        narrow results.
      </p>
      <i-table
        [data]="products"
        [columns]="filterableColumns"
        [sortable]="true"
        [filterable]="true"
        [globalFilter]="true"
        [height]="'350px'"
        (onSort)="onSort($event)"
        (onFilter)="onFilter($event)"
      >
      </i-table>
    </app-demo-card>

    <!-- Selection & Actions -->
    <app-demo-card
      [title]="'Selection & Row Actions'"
      [sourceCode]="codeExamples.actions"
    >
      <p class="demo-description">
        Select rows with checkboxes. Action buttons support conditional disable
        (delete disabled for out of stock).
        <strong>Selected: {{ selectedProducts.length }} products</strong>
      </p>
      <i-table
        [data]="products"
        [columns]="basicColumns"
        selectionMode="multiple"
        [(selection)]="selectedProducts"
        [showActions]="true"
        [actions]="tableActions"
        [striped]="true"
        [height]="'300px'"
        (onSelectionChange)="onSelectionChange($event)"
        (onAction)="handleAction($event)"
      >
      </i-table>
    </app-demo-card>

    <!-- Grouped Data with Actions -->
    <app-demo-card
      [title]="'Grouped Data'"
      [sourceCode]="codeExamples.groupedWithActions"
    >
      <p class="demo-description">
        Organize data into expandable groups. Click group headers to
        expand/collapse. Each row can have actions.
      </p>
      <i-table
        [groupedData]="groupedProductsWithActions"
        [columns]="basicColumns"
        [sortable]="true"
        [showActions]="true"
        [actions]="viewActions"
        [striped]="true"
        (onAction)="handleAction($event)"
      >
      </i-table>
    </app-demo-card>

    <!-- Icon Columns -->
    <app-demo-card
      [title]="'Icon Columns'"
      [sourceCode]="codeExamples.iconColumns"
    >
      <p class="demo-description">
        Display dynamic icons in table cells. Icons can be based on row data
        using functions or field references. This example shows status icons
        that change based on inventory levels.
      </p>
      <i-table
        [data]="products"
        [columns]="iconColumns"
        [striped]="true"
        [height]="'350px'"
      >
      </i-table>
    </app-demo-card>

    <!-- Visual Variants & Sizes -->
    <app-demo-card
      [title]="'Visual Variants & Sizes'"
      [sourceCode]="codeExamples.visual"
    >
      <div class="visual-examples">
        <div class="visual-example">
          <h4>Small - Striped & Bordered</h4>
          <i-table
            [data]="products.slice(0, 4)"
            [columns]="basicColumns"
            [striped]="true"
            [bordered]="true"
            size="small"
          >
          </i-table>
        </div>
        <div class="visual-example">
          <h4>Large Size</h4>
          <i-table
            [data]="products.slice(0, 3)"
            [columns]="basicColumns"
            size="large"
          >
          </i-table>
        </div>
      </div>
    </app-demo-card>

    <!-- Virtual Scroll - Large Dataset -->
    <app-demo-card
      [title]="'Virtual Scroll - 10,000 Rows'"
      [sourceCode]="codeExamples.virtualScroll"
    >
      <i-message severity="info" [closable]="false">
        Virtual scroll efficiently renders large datasets. This table has 10,000
        rows but only renders visible items.
      </i-message>
      <i-message severity="success" [closable]="false">
        Benefits: 10x-100x faster rendering, 90% less memory, smooth 60fps
        scrolling.
      </i-message>

      <i-table
        [data]="largeDataset"
        [columns]="sortableColumns"
        [virtualScroll]="true"
        [virtualScrollItemSize]="48"
        [height]="'500px'"
        [sortable]="true"
        [filterable]="true"
        [globalFilter]="true"
        [striped]="true"
        (onSort)="onSort($event)"
        (onFilter)="onFilter($event)"
      >
      </i-table>

      <i-message severity="info" [closable]="false" style="margin-top: 16px">
        Quick Start: Use [virtualScroll]="true" and [height]="'500px'" for
        tables with 1,000+ rows.
      </i-message>
    </app-demo-card>

    <!-- Virtual Scroll with Selection & Actions -->
    <app-demo-card
      [title]="'Virtual Scroll with Selection & Actions'"
      [sourceCode]="codeExamples.virtualScrollWithSelection"
    >
      <i-message severity="info" [closable]="false">
        Virtual scroll works with selection and actions. Selecting from 10,000
        items stays fast. Selected: {{ selectedProducts.length }}
      </i-message>

      <i-table
        [data]="largeDataset"
        [columns]="basicColumns"
        [virtualScroll]="true"
        [height]="'450px'"
        selectionMode="multiple"
        dataKey="id"
        [(selection)]="selectedProducts"
        [showActions]="true"
        [actions]="tableActions"
        [striped]="true"
        (onSelectionChange)="onSelectionChange($event)"
        (onAction)="handleAction($event)"
      >
      </i-table>

      <i-message severity="warning" [closable]="false" style="margin-top: 16px">
        Performance Tip: Always use dataKey="id" with selection for large
        datasets to improve performance.
      </i-message>
    </app-demo-card>

    <!-- Virtual Scroll Performance Comparison -->
    <app-demo-card
      [title]="'Virtual Scroll - Performance Comparison'"
      [sourceCode]="codeExamples.virtualScrollPerformance"
    >
      <div style="display: grid; gap: 20px">
        <div
          style="
            background: linear-gradient(
              135deg,
              var(--color-surface-200) 0%,
              var(--color-surface-300) 100%
            );
            padding: 20px;
            border-radius: 12px;
          "
        >
          <h3
            style="
              margin: 0 0 16px 0;
              color: var(--color-text-primary);
              display: flex;
              align-items: center;
              gap: 8px;
            "
          >
            <i class="pi pi-chart-bar" style="color: var(--color-primary)"></i>
            Performance Metrics (10,000 rows)
          </h3>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px">
            <!-- Without Virtual Scroll -->
            <div
              style="
                background: var(--color-surface-50);
                padding: 16px;
                border-radius: 8px;
                border-left: 4px solid var(--color-danger);
              "
            >
              <h4
                style="
                  margin: 0 0 12px 0;
                  color: var(--color-danger);
                  font-size: 0.9rem;
                "
              >
                Without Virtual Scroll
              </h4>
              <ul
                style="
                  margin: 0;
                  padding-left: 20px;
                  font-size: 0.85rem;
                  line-height: 1.8;
                "
              >
                <li><strong>DOM Nodes:</strong> 10,000+</li>
                <li><strong>Initial Render:</strong> ~2-3 seconds</li>
                <li><strong>Memory Usage:</strong> ~500MB</li>
                <li><strong>Scroll Performance:</strong> Laggy</li>
                <li><strong>Frame Rate:</strong> 15-30fps</li>
              </ul>
            </div>

            <!-- With Virtual Scroll -->
            <div
              style="
                background: var(--color-surface-50);
                padding: 16px;
                border-radius: 8px;
                border-left: 4px solid var(--color-success);
              "
            >
              <h4
                style="
                  margin: 0 0 12px 0;
                  color: var(--color-success);
                  font-size: 0.9rem;
                "
              >
                With Virtual Scroll
              </h4>
              <ul
                style="
                  margin: 0;
                  padding-left: 20px;
                  font-size: 0.85rem;
                  line-height: 1.8;
                "
              >
                <li><strong>DOM Nodes:</strong> ~30-50 (visible only)</li>
                <li><strong>Initial Render:</strong> ~50-100ms</li>
                <li><strong>Memory Usage:</strong> ~50MB</li>
                <li><strong>Scroll Performance:</strong> Smooth</li>
                <li><strong>Frame Rate:</strong> 60fps</li>
              </ul>
            </div>
          </div>

          <!-- Recommendations -->
          <div
            style="
              margin-top: 20px;
              padding: 16px;
              background: var(--color-primary-100);
              border-radius: 8px;
              border-left: 4px solid var(--color-primary);
            "
          >
            <h4
              style="
                margin: 0 0 12px 0;
                color: var(--color-primary);
                font-size: 0.9rem;
              "
            >
              When to Use Virtual Scroll
            </h4>
            <div
              style="
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                gap: 12px;
                font-size: 0.85rem;
              "
            >
              <div
                style="
                  text-align: center;
                  padding: 8px;
                  background: var(--color-surface-50);
                  border-radius: 6px;
                "
              >
                <div style="font-weight: 600; margin-bottom: 4px">
                  &lt; 100 rows
                </div>
                <div style="color: var(--color-text-secondary)">Not needed</div>
              </div>
              <div
                style="
                  text-align: center;
                  padding: 8px;
                  background: var(--color-surface-50);
                  border-radius: 6px;
                "
              >
                <div style="font-weight: 600; margin-bottom: 4px">
                  100-1K rows
                </div>
                <div style="color: var(--color-warning)">Optional</div>
              </div>
              <div
                style="
                  text-align: center;
                  padding: 8px;
                  background: var(--color-surface-50);
                  border-radius: 6px;
                "
              >
                <div style="font-weight: 600; margin-bottom: 4px">
                  1K-10K rows
                </div>
                <div style="color: var(--color-success)">Recommended</div>
              </div>
              <div
                style="
                  text-align: center;
                  padding: 8px;
                  background: var(--color-surface-50);
                  border-radius: 6px;
                "
              >
                <div style="font-weight: 600; margin-bottom: 4px">
                  &gt; 10K rows
                </div>
                <div style="color: var(--color-success)">Required</div>
              </div>
            </div>
          </div>

          <!-- Configuration Tips -->
          <div
            style="
              margin-top: 16px;
              padding: 16px;
              background: var(--color-info-100);
              border-radius: 8px;
            "
          >
            <h4
              style="
                margin: 0 0 12px 0;
                color: var(--color-info);
                font-size: 0.9rem;
              "
            >
              Configuration Properties
            </h4>
            <ul
              style="
                margin: 0;
                padding-left: 20px;
                font-size: 0.85rem;
                line-height: 1.8;
              "
            >
              <li>
                <code>[virtualScroll]="true"</code> - Enables virtual scrolling
              </li>
              <li>
                <code>[height]="'500px'"</code> - Required: Sets container
                height
              </li>
              <li>
                <code>[virtualScrollItemSize]="48"</code> - Row height in pixels
                (default: 48)
              </li>
              <li>
                <code>[virtualScrollMinBufferPx]="200"</code> - Min buffer
                before viewport (default: 200)
              </li>
              <li>
                <code>[virtualScrollMaxBufferPx]="400"</code> - Max buffer after
                viewport (default: 400)
              </li>
              <li>
                <code>dataKey="id"</code> - Important: Use with selection for
                best performance
              </li>
            </ul>
          </div>
        </div>
      </div>
    </app-demo-card>

    <!-- Empty State -->
    <app-demo-card
      [title]="'Empty State'"
      [sourceCode]="codeExamples.emptyState"
    >
      <p class="demo-description">
        When a table has no data, the table component automatically displays an
        empty state with a friendly icon and message.
      </p>
      <i-table [data]="emptyProducts" [columns]="basicColumns" [striped]="true">
      </i-table>
    </app-demo-card>

    <!-- Custom Header & Download -->
    <app-demo-card
      [title]="'Custom Header & Export'"
      [sourceCode]="codeExamples.download"
    >
      <p class="demo-description">
        Add custom header content with ng-content. Export data to CSV, JSON, or
        Excel.
      </p>
      <i-table
        [data]="products"
        [columns]="fullColumns"
        [globalFilter]="true"
        [downloadable]="true"
        downloadMode="direct"
        downloadFormat="csv"
        downloadFilename="products-inventory"
        [striped]="true"
      >
        <div header style="display: flex; align-items: center; gap: 8px">
          <i
            class="pi pi-box"
            style="font-size: 1.5rem; color: var(--color-primary)"
          ></i>
          <h3 style="margin: 0; font-size: 1.1rem">Product Inventory</h3>
        </div>
      </i-table>
    </app-demo-card>

    <!-- Full Featured Table -->
    <app-demo-card
      [title]="'Full Featured Example'"
      [sourceCode]="codeExamples.full"
    >
      <p class="demo-description">
        All features combined: sorting, filtering, selection, actions, and
        visual customization.
      </p>
      <i-table
        [data]="products"
        [columns]="fullColumns"
        [downloadable]="true"
        downloadMode="direct"
        downloadFormat="csv"
        downloadFilename="products-full"
        [sortable]="true"
        [filterable]="true"
        [globalFilter]="true"
        selectionMode="multiple"
        [(selection)]="selectedProducts"
        [showActions]="true"
        [actions]="tableActions"
        [striped]="true"
        [hoverable]="true"
        (onSort)="onSort($event)"
        (onFilter)="onFilter($event)"
        (onSelectionChange)="onSelectionChange($event)"
        (onAction)="handleAction($event)"
      >
        <div header style="display: flex; align-items: center; gap: 8px">
          <i
            class="pi pi-box"
            style="font-size: 1.25rem; color: var(--color-primary)"
          ></i>
          <h3 style="margin: 0; font-size: 1.1rem">Product Inventory â€” Full</h3>
        </div>
      </i-table>
    </app-demo-card>

    <!-- Features -->
    <app-demo-card [title]="'Features'">
      <app-features-list [features]="features"></app-features-list>
    </app-demo-card>
  </div>
</div>
