<div class="dialogs-demo">
  <header class="demo-header">
    <h1>Dialog Components</h1>
    <p>
      Modal dialog components with dynamic service-based and template-based
      implementations. Flexible and accessible dialogs for displaying content,
      forms, and user interactions.
    </p>
  </header>

  <div class="cards-container">
    <!-- Dynamic Dialog Example -->
    <app-demo-card
      [title]="'Dynamic Dialog Service'"
      [sourceCode]="codeExamples.dynamic"
      [tsCode]="dynamicDialogTsCode"
    >
      <div class="demo-content">
        <p>
          Use the DialogService to programmatically open dialogs with
          components.
        </p>
        <i-button severity="primary" (clicked)="displayExampleDialog()"
          >Open Dynamic Dialog</i-button
        >
      </div>
    </app-demo-card>

    <!-- Basic Template Dialog -->
    <app-demo-card
      [title]="'Basic Template Dialog'"
      [sourceCode]="codeExamples.basic"
    >
      <div class="demo-content">
        <p>
          Use the i-dialog component directly in your template for declarative
          dialogs.
        </p>
        <i-button
          severity="secondary"
          [outlined]="true"
          (clicked)="showBasicDialogModal()"
          >Open Basic Dialog</i-button
        >
      </div>

      <!-- Basic Dialog Template -->
      <i-dialog
        [(visible)]="showBasicDialog"
        [closable]="true"
        header="Welcome to Integra"
        width="500px"
        height="400px"
        [breakpoints]="{
          '640px': { width: '576px', height: '510px' },
        }"
      >
        <div class="dialog-content basic-dialog">
          <div class="dialog-icon">
            <i class="pi pi-check-circle"></i>
          </div>
          <h4>Getting Started</h4>
          <p class="dialog-description">
            Welcome to the Integra component library! This dialog demonstrates a
            clean, user-friendly design with proper spacing and hierarchy.
          </p>
          <div class="feature-highlights">
            <div class="highlight-item">
              <i class="pi pi-bolt"></i>
              <span>Fast & Responsive</span>
            </div>
            <div class="highlight-item">
              <i class="pi pi-shield"></i>
              <span>Accessible (WCAG 2.1)</span>
            </div>
            <div class="highlight-item">
              <i class="pi pi-palette"></i>
              <span>Themeable</span>
            </div>
          </div>
          <div
            class="tooltip-test"
            style="
              margin-top: 16px;
              display: flex;
              gap: 8px;
              justify-content: center;
            "
          >
            <i-button
              severity="info"
              [outlined]="true"
              iTooltip="This tooltip should appear above the dialog"
              tooltipPosition="above"
            >
              <i class="pi pi-info-circle"></i>
              Hover me
            </i-button>
          </div>
        </div>
        <i-dialog-actions
          slot="footer"
          (cancelEvent)="onBasicDialogHide()"
          (submitEvent)="onBasicDialogHide()"
          submitLabel="Get Started"
          cancelLabel="Maybe Later"
        ></i-dialog-actions>
      </i-dialog>
    </app-demo-card>

    <!-- Single Button Dialog -->
    <app-demo-card
      [title]="'Single Button Dialog'"
      [sourceCode]="codeExamples.singleButton"
    >
      <div class="demo-content">
        <p>
          Dialog with only one button by setting [showCancel]="false" on dialog
          actions.
        </p>
        <i-button severity="success" (clicked)="showSingleButtonDialogModal()"
          >Open Single Button Dialog</i-button
        >
      </div>

      <!-- Single Button Dialog Template -->
      <i-dialog
        [(visible)]="showSingleButtonDialog"
        [closable]="true"
        header="Notification"
        width="24rem"
        [breakpoints]="{
          '640px': { width: '576px' },
        }"
      >
        <div class="dialog-content basic-dialog">
          <div class="dialog-icon success">
            <i class="pi pi-check-circle"></i>
          </div>
          <h4>Success!</h4>
          <p class="dialog-description">
            Your changes have been saved successfully. This dialog only has one
            action button for acknowledgment.
          </p>
        </div>
        <i-dialog-actions
          slot="footer"
          (submitEvent)="onSingleButtonDialogHide()"
          submitLabel="OK"
          [showCancel]="false"
        ></i-dialog-actions>
      </i-dialog>
    </app-demo-card>

    <!-- Responsive Dialog -->
    <app-demo-card
      [title]="'Responsive Dialog'"
      [sourceCode]="codeExamples.responsive"
    >
      <div class="demo-content">
        <p>Dialogs that adapt to different screen sizes using breakpoints.</p>
        <i-button severity="info" (clicked)="showResponsiveDialogModal()"
          >Open Responsive Dialog</i-button
        >
      </div>

      <!-- Responsive Dialog Template -->
      <i-dialog
        [(visible)]="showResponsiveDialog"
        header="Screen Size Adaptation"
        width="800px"
        height="600px"
        [breakpoints]="{
          '960px': { width: '720px', height: '420px' },
          '640px': { width: '576px', height: '480px' },
        }"
      >
        <div class="dialog-content responsive-dialog">
          <div class="responsive-info-card">
            <div class="info-header">
              <i class="pi pi-desktop"></i>
              <h5>Current Breakpoint</h5>
            </div>
            <p class="breakpoint-indicator">
              Resize your browser to see the dialog adapt automatically.
            </p>
          </div>

          <div class="breakpoints-grid">
            <div class="breakpoint-card">
              <div class="breakpoint-icon">
                <i class="pi pi-desktop"></i>
              </div>
              <div class="breakpoint-details">
                <strong>Desktop</strong>
                <span class="breakpoint-value">50vw</span>
                <small>> 960px</small>
              </div>
            </div>
            <div class="breakpoint-card">
              <div class="breakpoint-icon">
                <i class="pi pi-tablet"></i>
              </div>
              <div class="breakpoint-details">
                <strong>Tablet</strong>
                <span class="breakpoint-value">75vw</span>
                <small>≤ 960px</small>
              </div>
            </div>
            <div class="breakpoint-card">
              <div class="breakpoint-icon">
                <i class="pi pi-mobile"></i>
              </div>
              <div class="breakpoint-details">
                <strong>Mobile</strong>
                <span class="breakpoint-value">90vw</span>
                <small>≤ 640px</small>
              </div>
            </div>
          </div>

          <p class="responsive-tip">
            <i class="pi pi-info-circle"></i>
            All dialogs are constrained to a maximum height of 80vh for optimal
            mobile experience.
          </p>
        </div>
        <i-dialog-actions
          slot="footer"
          (cancelEvent)="onResponsiveDialogHide()"
          (submitEvent)="onResponsiveDialogHide()"
          submitLabel="Got It"
          cancelLabel="Close"
        ></i-dialog-actions>
      </i-dialog>
    </app-demo-card>

    <!-- Dropdown Test Dialog -->
    <app-demo-card [title]="'Dialog with Dropdowns (Test Case)'">
      <div class="demo-content">
        <p>
          <strong>Testing dropdown behavior in dialogs:</strong> This dialog
          contains select and multi-select dropdowns. Click inside the dialog
          but outside an expanded dropdown to test if it properly closes.
        </p>
        <i-button severity="danger" (clicked)="showDropdownTestDialogModal()"
          >Open Dropdown Test Dialog</i-button
        >
      </div>

      <!-- Dropdown Test Dialog Template -->
      <i-dialog
        [(visible)]="showDropdownTestDialog"
        header="Dropdown Test in Dialog"
        width="600px"
        height="500px"
        [breakpoints]="{
          '960px': { width: '720px', height: '420px' },
          '640px': { width: '576px', height: '480px' },
        }"
      >
        <div class="dialog-content" style="height: 100%">
          <div class="dropdown-test-instruction">
            <strong>Test Instructions:</strong>
            <ol style="margin: 8px 0 0 0; padding-left: 20px">
              <li>Open the "Country" dropdown below</li>
              <li>
                Click anywhere else in the dialog (but not on the dropdown)
              </li>
              <li>
                Observe if the dropdown closes automatically (expected behavior)
              </li>
              <li>Repeat with the "Skills" multi-select dropdown</li>
            </ol>
          </div>

          <form
            [formGroup]="dropdownTestForm"
            style="display: flex; flex-direction: column; gap: 16px"
          >
            <div class="form-field">
              <i-select
                id="country"
                label="Country"
                [options]="countryOptions"
                optionLabel="label"
                formControlName="country"
                [filter]="true"
                [showClear]="true"
                [fluid]="true"
              >
              </i-select>
              @if (
                dropdownTestForm.get("country")?.invalid &&
                dropdownTestForm.get("country")?.touched
              ) {
                <small class="error-message">
                  <i class="pi pi-exclamation-circle"></i>
                  Please select a country
                </small>
              }
            </div>

            <div class="form-field">
              <i-multi-select
                id="skills"
                label="Skills"
                [options]="skillOptions"
                optionLabel="label"
                formControlName="skills"
                [filter]="true"
                [showClear]="true"
                [fluid]="true"
                [maxSelectedLabels]="3"
                selectedItemsLabel="{0} skills selected"
              >
              </i-multi-select>
              @if (
                dropdownTestForm.get("skills")?.invalid &&
                dropdownTestForm.get("skills")?.touched
              ) {
                <small class="error-message">
                  <i class="pi pi-exclamation-circle"></i>
                  Please select at least one skill
                </small>
              }
            </div>

            <div class="dropdown-values-panel">
              <p style="margin: 0; font-size: 14px">
                <strong>Current Values:</strong><br />
                Country:
                {{ dropdownTestForm.get("country")?.value?.label || "None"
                }}<br />
                Skills:
                {{ (dropdownTestForm.get("skills")?.value || []).length }}
                selected
              </p>
            </div>
          </form>
        </div>
        <i-dialog-actions
          slot="footer"
          (cancelEvent)="onDropdownTestDialogHide()"
          (submitEvent)="onDropdownTestDialogSubmit()"
          submitLabel="Submit"
          cancelLabel="Cancel"
          [submitDisabled]="dropdownTestForm.invalid"
        ></i-dialog-actions>
      </i-dialog>
    </app-demo-card>

    <!-- Large Dialog -->
    <app-demo-card
      [title]="'Large Dialog'"
      [sourceCode]="codeExamples.fullscreen"
    >
      <div class="demo-content">
        <p>Dialogs with larger dimensions for complex content.</p>
        <i-button severity="warning" (clicked)="showFullscreenDialogModal()"
          >Open Large Dialog</i-button
        >
      </div>

      <!-- Fullscreen Dialog Template -->
      <i-dialog
        [(visible)]="showFullscreenDialog"
        header="Team Assignment"
        [modal]="true"
        width="600px"
        height="800px"
        [breakpoints]="{
          '960px': { width: '768px', height: '680px' },
          '640px': { width: '608px', height: '720px' },
        }"
      >
        <div class="dialog-content large-dialog">
          <div class="dialog-intro">
            <i class="pi pi-users"></i>
            <div>
              <h4>Select Team Departments</h4>
              <p>Choose the departments you want to assign to this project.</p>
            </div>
          </div>

          <form [formGroup]="largeDialogForm" class="listbox-demo-form">
            <div class="form-field">
              <i-listbox
                id="selectedDepartments"
                label="Available Departments"
                [options]="departmentOptions$ | async"
                optionLabel="label"
                optionValue="value"
                formControlName="selectedDepartments"
                [multiple]="true"
                [filter]="true"
                [showClear]="true"
                [maxSelectedLabels]="2"
                selectedItemsLabel="{0} departments selected"
              >
              </i-listbox>

              @if (
                largeDialogForm.get("selectedDepartments")?.invalid &&
                largeDialogForm.get("selectedDepartments")?.touched
              ) {
                <small class="error-message">
                  <i class="pi pi-exclamation-circle"></i>
                  Please select at least one department
                </small>
              }
            </div>
          </form>

          <div class="selection-summary">
            <div class="summary-header">
              <i class="pi pi-chart-bar"></i>
              <span>Selection Summary</span>
            </div>
            <div class="summary-stats">
              <div class="stat-item">
                <span class="stat-value">{{
                  (largeDialogForm.get("selectedDepartments")?.value || [])
                    .length
                }}</span>
                <span class="stat-label">Selected</span>
              </div>
              <div class="stat-item">
                <span class="stat-value">{{
                  (departmentOptions$ | async)?.length || 0
                }}</span>
                <span class="stat-label">Available</span>
              </div>
              <div
                class="stat-item status"
                [class.valid]="largeDialogForm.valid"
              >
                <i
                  [class]="
                    largeDialogForm.valid
                      ? 'pi pi-check-circle'
                      : 'pi pi-times-circle'
                  "
                ></i>
                <span class="stat-label">{{
                  largeDialogForm.valid ? "Ready" : "Incomplete"
                }}</span>
              </div>
            </div>
          </div>
        </div>
        <i-dialog-actions
          slot="footer"
          (cancelEvent)="onFullscreenDialogHide()"
          (submitEvent)="onFullscreenDialogSubmit()"
          submitLabel="Assign Departments"
          cancelLabel="Cancel"
          [submitDisabled]="largeDialogForm.invalid"
        ></i-dialog-actions>
      </i-dialog>
    </app-demo-card>

    <!-- Features -->
    <app-demo-card [title]="'Features'">
      <app-features-list [features]="features"></app-features-list>
    </app-demo-card>
  </div>
</div>
